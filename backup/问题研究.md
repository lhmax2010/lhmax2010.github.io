[  154s] [  5%] Building ASM object projects/compiler-rt/lib/builtins/CMakeFiles/clang_rt.builtins-arm.dir/arm/sync_fetch_and_umax_4.S.o
[  154s] [  5%] Building ASM object projects/compiler-rt/lib/builtins/CMakeFiles/clang_rt.builtins-arm.dir/arm/sync_fetch_and_umax_8.S.o
[  154s] /home/abuild/rpmbuild/BUILD/llvm-19.1.4/compiler-rt/lib/builtins/truncdfbf2.c: In function '__truncdfbf2':
[  154s] /home/abuild/rpmbuild/BUILD/llvm-19.1.4/compiler-rt/lib/builtins/truncdfbf2.c:13:74: error: unrecognizable insn:
[  154s]    13 | COMPILER_RT_ABI dst_t __truncdfbf2(double a) { return __truncXfYf2__(a); }
[  154s]       |                                                                          ^
[  154s] (insn 298 297 302 57 (set (reg:BF 156 [ <retval> ])
[  154s]         (subreg:BF (reg:HI 273) 0)) "/home/abuild/rpmbuild/BUILD/llvm-19.1.4/compiler-rt/lib/builtins/truncdfbf2.c":13:55 discrim 1 -1
[  154s]      (nil))
[  154s] during RTL pass: vregs
[  154s] /home/abuild/rpmbuild/BUILD/llvm-19.1.4/compiler-rt/lib/builtins/truncdfbf2.c:13:74: internal compiler error: in extract_insn, at recog.cc:2812
[  154s] 0x1a7c782 internal_error(char const*, ...)
[  154s] 	???:0
[  154s] 0x725e97 fancy_abort(char const*, int, char const*)
[  154s] 	???:0
[  154s] 0x70298b _fatal_insn(char const*, rtx_def const*, char const*, int, char const*)
[  154s] 	???:0
[  154s] 0x7029aa _fatal_insn_not_found(rtx_def const*, char const*, int, char const*)
[  154s] 	???:0
[  154s] Please submit a full bug report, with preprocessed source (by using -freport-bug).
[  154s] Please include the complete backtrace with any bug report.
[  154s] See <http://bugs.tizen.org/> for instructions.
[  154s] make[2]: *** [projects/compiler-rt/lib/builtins/CMakeFiles/clang_rt.builtins-armv4t.dir/build.make:2044: projects/compiler-rt/lib/builtins/CMakeFiles/clang_rt.builtins-armv4t.dir/truncdfbf2.c.o] Error 1
[  154s] make[1]: *** [CMakeFiles/Makefile2:31284: projects/compiler-rt/lib/builtins/CMakeFiles/clang_rt.builtins-armv4t.dir/all] Error 2
[  154s] make[1]: *** Waiting for unfinished jobs....

问题分析
看日志这是在编 compiler-rt 的 builtins（目标库：clang_rt.builtins-armv4t）时，文件 truncdfbf2.c 里实现 double -> bfloat16 转换的例程在 GCC 上崩了（reg:BF / BF=bfloat16）。ARMv4T 后端并不真正支持 BFLOAT16 的指令/模式，GCC 前端虽然能接受 __bf16 这个类型，但到后端生成 RTL 时就炸在 extract_insn（“unrecognizable insn … reg:BF … during RTL pass: vregs”），这属于编译器/目标组合不支持 BFMODE 的经典坑，不是你的工程代码问题。对应的源文件确实是 bfloat16 截断实现：lib/builtins/truncdfbf2.c（就是把 DST_BFLOAT 打开后包含通用实现）
[Code Browser](https://codebrowser.dev/llvm/compiler-rt/lib/builtins/truncdfbf2.c.html)
。
在 CMake 里，compiler-rt 只有在检测到 __bf16 类型“可编译”时才会把这批 BF16 源加入构建（BF16_SOURCES 列表）；每个目标架构都会做一次 check_c_source_compiles("__bf16 ...", COMPILER_RT_HAS_${arch}_BFLOAT16)，若为真就把 BF16_SOURCES 追加进该架构的源码列表。你的环境里这一步误判为“可用”，于是把 truncdfbf2.c 等文件编进去，随后在 ARMv4T 的 GCC 后端挂了。相关 CMake 逻辑可见这里（定义 BF16 源并按每个 arch 判断是否加入）
[fossies.org](https://fossies.org/linux/llvm-project-llvmorg/compiler-rt/lib/builtins/CMakeLists.txt)
。LLVM 也专门有改动说明“只在（确实）支持时构建 (b)float16 代码”

尝试方案
# 先清理旧的构建目录（重要）
rm -rf build && mkdir build
cd build

cmake -G Ninja ../llvm \
  -DLLVM_ENABLE_PROJECTS="clang;compiler-rt" \
  -DLLVM_ENABLE_RUNTIMES="compiler-rt" \
  -DLLVM_BUILTIN_TARGETS="armv4t-linux-gnueabi" \
  -DBUILTINS_armv4t-linux-gnueabi_CMAKE_SYSTEM_NAME=Linux \
  -DBUILTINS_armv4t-linux-gnueabi_TARGET_TRIPLE=armv4t-linux-gnueabi \
  -DBUILTINS_armv4t-linux-gnueabi_CMAKE_C_FLAGS="-march=armv4t -mfloat-abi=soft" \
  **-DCOMPILER_RT_HAS_armv4t_BFLOAT16=OFF**

ninja clang_rt.builtins-armv4t
